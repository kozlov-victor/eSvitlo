#ifndef SVITLO_APP_SERVICE_H
#define SVITLO_APP_SERVICE_H
#include <Arduino.h>
#include "../libs/server/v_service/v_service.h"
#include "../libs/display/display.h"

static const uint8_t logo[] PROGMEM = {
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
    0x00, 0x3E, 0x00, 0x00, 0x10, 0x10, 0x03, 0xF0, 0x00, 0x22, 0x00, 0x04, 0x10, 0x18, 0x06, 0x10, 0x00, 0x20, 0x00, 0x00,
    0x08, 0x08, 0x0C, 0x18, 0x00, 0x20, 0x40, 0x00, 0x08, 0x08, 0x08, 0x08, 0x00, 0x20, 0x40, 0x64, 0x08, 0x08, 0x08, 0x08,
    0x00, 0x30, 0x20, 0x44, 0x7F, 0x08, 0x08, 0x08, 0x1F, 0x18, 0x20, 0x44, 0x88, 0x08, 0x08, 0x08, 0x31, 0x0E, 0x10, 0x84,
    0x08, 0x08, 0x08, 0x08, 0x21, 0x02, 0x10, 0x84, 0x08, 0x08, 0x08, 0x18, 0x3F, 0x03, 0x08, 0x84, 0x08, 0x08, 0x0C, 0x10,
    0x20, 0x01, 0x0C, 0x84, 0x08, 0x08, 0x04, 0x10, 0x20, 0x01, 0x05, 0x04, 0x08, 0x08, 0x04, 0x10, 0x21, 0x03, 0x07, 0x04,
    0x08, 0x08, 0x06, 0x30, 0x37, 0x66, 0x03, 0x00, 0x0F, 0xEF, 0xF3, 0xE0, 0x1C, 0x3C, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x19, 0xF8, 0x01, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x39,
    0x84, 0x01, 0x7F, 0x80, 0x00, 0x7E, 0xF0, 0x27, 0x04, 0x01, 0x18, 0x80, 0x00, 0x43, 0x88, 0x30, 0x0C, 0x01, 0x80, 0x80,
    0x00, 0x43, 0x18, 0x10, 0x18, 0x00, 0xC0, 0x80, 0x00, 0x40, 0x10, 0x18, 0x10, 0x00, 0x61, 0x80, 0x00, 0x60, 0x30, 0x06,
    0x30, 0x00, 0x33, 0x00, 0x00, 0x30, 0x60, 0x03, 0xA0, 0x00, 0x1E, 0x00, 0x00, 0x18, 0x40, 0x00, 0xE0, 0x00, 0x04, 0x00,
    0x00, 0x0E, 0xC0, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x80, 0x00, 0x00, 0x00, 0x00, 0x00
};

class AppService {
Service(AppService)

private:
    Display *display;

public:
    AppService() {
        display = new Display();
    }

    ~AppService() {
        delete display;
    }

    String lastPingResponse = "";
    boolean isAccessPoint = false;
    long tickCnt = 0;

    void setup() {
        display->begin(); // 72X40
        display->setOffset(36,25);
    }

    void log(const String &str) const {
        display->clear();
        display->drawText(0,0,str);
        display->update();
    }

    void drawLogo() const {
        display->clear();
        display->drawBitmap(0,0,63,32,logo);
        display->update();
    }

};

#endif //SVITLO_APP_SERVICE_H